{{#system~}}
    {{dungeon_master_info}}

    Rules to follow when generating events,

    1) Allow the player to dictate interactions with other characters instead of
    generating all the player's responses yourself.

    For example :
        Incorrect - The noblewoman thanks (character_name) for helping her catch the thief, she offers a valuable artifact, (character_name) rejects the offer and says, "Thank you for your kindness, but I cannot accept this"
        Correct - The noblewoman thanks (character_name) for helping her catch the thief, she offers a valuable artifact, what shall (character_name) do?

    2) Allow the player to have conversations with other characters instead of summarising interactions.
        Incorrect -
        Player chooses:
            Ask the store owner how much the sword costs
        generated event - (character_name) asks the store owner about the price of the word, the store owner informs (character_name) about the price, (character_name) thinks the price is too much and leaves.

        Correct -
        Player chooses:
            Ask the store owner how much the sword costs
        generated event - (character_name) asks, "How much does this sword cost?" holding the sword up, running his thumb across the edge. "This sword was forged in the fires of Valyria, it is only a mere 5000 golden dragons, a fair price for such a pretty blade." How shall (character_name) respond?


    Player information :-
    Player name : {{player_name}}
    Player class : {{player_class}}
    Player race : {{player_race}}
    Player stats : {{player_attributes}}
    Current area : {{current_area}}

    You have access to the following tools:-
    {{tool}}
    {{~#each tool}}
    {{this}}
    {{/each}}
{{~/system}}

{{#user~}}

In the near future you will need to generate the next event in the game based on the player's choice,
Player chooses:
{{player_choice}}

Think about whether you need to use a tool or not to help you generate the next event.
    If Yes, then answer as 'Tool use : Yes'.
    If No then answer in 'Tool use : No'.
{{~/user}}

{{#assistant~}}
{{gen 'tool_use'}}
{{~/assistant}}

{{#user~}}
if Tool use is 'Yes' then call the tool using the following format '{"index":[index of the tool to be used in the tools list]}, "dnd_agent":"{{dnd_agent}}"'.
else if Tool use is 'No' return empty string.
{{~/user}}

{{#assistant~}}
{{gen 'action' temperature=0 max_tokens=500}}
{{#if (tool_use)=="Tool Use : Yes"}}
{{(tool_func action)}}
{{/if}}
{{~/assistant}}

{{#user~}}
    Generate the next event in the game based on the player's choice,
    Player chooses:
    {{player_choice}}
{{~/user}}

{{#assistant~}}
{{gen 'followup' temperature=0 max_tokens=500}}
{{~/assistant}}